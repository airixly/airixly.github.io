<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/main.css">

    <title>CentOS安装MySQL5.6及远程连接</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/airixly">View on GitHub</a>

          <h1 id="project_title"></h1>
          <h2 id="project_tagline">Airixly</h2>

        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h2>CentOS安装MySQL5.6及远程连接</h2>
<p class="meta">21 Sep 2013</p>

<div class="post">
<p>首先从mysql官网下载MySQL Community Server，在Select Platform处选择Source Code，然后选择Generic Linux(Architecture Independent)，Compressed TAR Archive。</p>

<p>在MySQL 5.6中，所有平台都使用了CMAKE来进行编译，在安装MySQL之前，要先安装好gcc等依赖包和CMAKE。</p>

<p>安装gcc和缺少的依赖包：</p>

<div class="highlight"><pre><code class="ruby"><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">gcc</span><span class="o">-</span><span class="n">c</span><span class="o">++</span>
<span class="n">sudo</span> <span class="n">yum</span> <span class="n">isntall</span> <span class="n">ncurses</span><span class="o">-</span><span class="n">devel</span>
</code></pre></div>

<p>然后安装CMAKE：</p>

<div class="highlight"><pre><code class="ruby"><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">cmake</span> <span class="n">cmake</span><span class="o">-</span><span class="n">gui</span>
</code></pre></div>

<p>准备工作完成后，在shell中向系统新增用户组和用户“mysql”：</p>

<div class="highlight"><pre><code class="ruby"><span class="n">sudo</span> <span class="n">groupadd</span> <span class="n">mysql</span>
<span class="n">sudo</span> <span class="n">useradd</span> <span class="o">-</span><span class="n">r</span> <span class="o">-</span><span class="n">g</span> <span class="n">mysql</span> <span class="n">mysql</span>
</code></pre></div>

<p>现在进入mysql-VERSION.tar.gz所在目录，编译源码，完成安装：</p>

<div class="highlight"><pre><code class="ruby"><span class="n">tar</span> <span class="n">zxvf</span> <span class="n">mysql</span><span class="o">-</span><span class="no">VERSION</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="n">mysql</span><span class="o">-</span><span class="no">VERSION</span>
<span class="n">cmake</span> <span class="o">.</span>
<span class="n">make</span>
<span class="n">sudo</span> <span class="n">make</span> <span class="n">install</span>
</code></pre></div>

<p>安装完成后，进行初始化设置：</p>

<div class="highlight"><pre><code class="ruby"><span class="n">cd</span> <span class="sr">/usr/</span><span class="n">local</span><span class="o">/</span><span class="n">mysql</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">mysql</span> <span class="o">.</span>
<span class="n">sudo</span> <span class="n">chgrp</span> <span class="o">-</span><span class="n">R</span> <span class="n">mysql</span> <span class="o">.</span>
<span class="n">sudo</span> <span class="n">scripts</span><span class="o">/</span><span class="n">mysql_install_db</span> <span class="o">--</span><span class="n">user</span><span class="o">=</span><span class="n">mysql</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">root</span> <span class="o">.</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">mysql</span> <span class="n">data</span>
</code></pre></div>

<p>接着运行mysql服务：</p>

<div class="highlight"><pre><code class="ruby"><span class="n">sudo</span> <span class="n">bin</span><span class="o">/</span><span class="n">mysqld_safe</span> <span class="o">--</span><span class="n">user</span><span class="o">=</span><span class="n">mysql</span> <span class="o">&amp;</span>
</code></pre></div>

<p>测试服务是否启动成功：</p>

<div class="highlight"><pre><code class="ruby"><span class="n">sudo</span> <span class="n">bin</span><span class="o">/</span><span class="n">mysqladmin</span> <span class="n">version</span>
</code></pre></div>

<p>若出现mysqld_safe starting mysqld daemon with databases from /var/lib/mysql和[ERROR]Cant&#39;t open the mysql.plugin table的错误信息，修改mysql配置文件：</p>

<div class="highlight"><pre><code class="ruby"><span class="n">sudo</span> <span class="n">vi</span> <span class="sr">/usr/</span><span class="n">local</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">my</span><span class="o">.</span><span class="n">cnf</span>
</code></pre></div>

<p>加入下面两行：
basedir=/usr/local/mysql
datadir=/usr/local/mysql/data</p>

<p>重新启动mysql，再运行测试命令，若正确打印出版本信息，则表示启动成功，关闭mysql服务的命令是：</p>

<div class="highlight"><pre><code class="ruby"><span class="n">sudo</span> <span class="n">bin</span><span class="o">/</span><span class="n">mysqladmin</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span> <span class="n">shutdown</span>
</code></pre></div>

<p>MySQL服务正常启动后，最好对mysql默认用户设置密码，现在先启动mysql：</p>

<div class="highlight"><pre><code class="ruby"><span class="n">sudo</span> <span class="n">bin</span><span class="o">/</span><span class="n">mysql</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span>
</code></pre></div>

<p>为root用户和匿名用户设置密码：</p>

<div class="highlight"><pre><code class="ruby"><span class="no">UPDATE</span> <span class="n">mysql</span><span class="o">.</span><span class="n">user</span> <span class="no">SET</span> <span class="no">PASSWORD</span><span class="o">=</span><span class="no">PASSWORD</span><span class="p">(</span><span class="s1">&#39;yourpassword&#39;</span><span class="p">)</span>
  <span class="no">WHERE</span> <span class="no">USER</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">;</span>
<span class="no">UPDATE</span> <span class="n">mysql</span><span class="o">.</span><span class="n">user</span> <span class="no">SET</span> <span class="no">PASSWORD</span><span class="o">=</span><span class="no">PASSWORD</span><span class="p">(</span><span class="s1">&#39;yourpassword&#39;</span><span class="p">)</span>
  <span class="no">WHERE</span> <span class="no">USER</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="no">FLUSH</span> <span class="no">PRIVILEGES</span><span class="p">;</span>
</code></pre></div>

<p>现在新增一个用户：</p>

<div class="highlight"><pre><code class="ruby"><span class="no">GRANT</span> <span class="no">ALL</span> <span class="no">PRIVILEGES</span> <span class="no">ON</span> <span class="o">*.</span><span class="n">*</span> <span class="no">TO</span> <span class="s1">&#39;test&#39;</span><span class="err">@</span><span class="s1">&#39;localhost&#39;</span>
  <span class="no">IDENTIFIED</span> <span class="no">BY</span> <span class="s1">&#39;yourpassword&#39;</span> <span class="no">WITH</span> <span class="no">GRANT</span> <span class="no">OPTION</span><span class="p">;</span>
<span class="no">GRANT</span> <span class="no">ALL</span> <span class="no">PRIVILEGES</span> <span class="no">ON</span> <span class="o">*.</span><span class="n">*</span> <span class="no">TO</span> <span class="s1">&#39;test&#39;</span><span class="err">@</span><span class="s1">&#39;yourip&#39;</span> <span class="no">IDENTIFIED</span>
  <span class="no">BY</span> <span class="s1">&#39;yourpassword&#39;</span> <span class="no">WITH</span> <span class="no">GRANT</span> <span class="no">OPTION</span><span class="p">;</span>
</code></pre></div>

<p>虚拟机上的网络模式用的是NAT，这里的“yourip”是宿主机上，运行“ifconfig”后,vmnet8中inet后的ip值。
现在打开虚拟机linux系统的3306端口：</p>

<div class="highlight"><pre><code class="ruby"><span class="n">sudo</span> <span class="n">iptables</span> <span class="o">-</span><span class="n">I</span> <span class="no">INPUT</span> <span class="o">-</span><span class="nb">p</span> <span class="n">tcp</span> <span class="o">-</span><span class="n">m</span> <span class="n">state</span> <span class="o">--</span><span class="n">state</span> <span class="no">NEW</span> <span class="o">-</span><span class="n">m</span> <span class="n">tcp</span>
  <span class="o">--</span><span class="n">dport</span> <span class="mi">3306</span> <span class="o">-</span><span class="n">j</span> <span class="no">ACCEPT</span>
</code></pre></div>

<p>设置完成后，在宿主机上运行NAVICAT，使用刚才新增的用户名，密码及虚拟机IP配置连接信息，测试连接，连接成功后即可在宿主机上操作虚拟机中的MySQL。</p>

</div>

<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'airixly'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">

      </footer>
    </div>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-44221090-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>
  </body>
</html>
